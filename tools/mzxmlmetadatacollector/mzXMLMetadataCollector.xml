<tool id="mzxmlmetadatacollector" name="mz(X)MLMetadataCollector" version="1.0.0+galaxy0" profile="21.01">
  <description>
    gathers mzML and mzXML metadata into a tabular file
  </description>
  <requirements>
    <requirement type="package" version="2.1.0">numpy</requirement>
  </requirements>
  <command detect_errors="aggressive"><![CDATA[
    python '$__tool_directory__/mzXMLMetadataCollector.py' '$outputFile' '$input.singleFile' 
    #if $input.singleFile=="MULTIPLE"
      '$input.inputFiles'
      #for $i in $input.inputFiles
        '$i.name'
      #end for 
    #else if $input.singleFile=="SINGLE"
      '$input.SingleInputFile'
      '$input.SingleInputFile.name'
    #end if
  ]]></command>
  <inputs>
    <conditional name = "input">
      <param name="singleFile" type="select" label="Number of files to process">
        <option value = "MULTIPLE">Multiple Files or collection</option> 
        <option value = "SINGLE">Single File</option>
      </param>
      <when value="MULTIPLE">
        <param name="inputFiles" type="data" format="mzml,mzxml" label="Files to examine" help="Multiple files to examine" multiple="true"/>
      </when>
      <when value="SINGLE">
        <param name="SingleInputFile" type="data" format="mzml,mzxml" label="File to examine" help="Single file to examine"/>
      </when>
    </conditional>
  </inputs> 
  <outputs>
    <data format="tabular" label="metadata.tabular" name="outputFile"/>
  </outputs>
  <tests>
    <test>
      <param name="singleFile" value="MULTIPLE"/>
      <param name="inputFiles" value="QC autoMSMS_10_1_2969.mzML,QC_20autoMSMS_10_1_2969.mzXML,Pos_Xenobio_DDA_30_35CE_incl_90_Spk_3_A2.mzML,Pos_Xenobio_DDA_30_35CE_incl_90_Spk_3_A.mzML,OE240_DS_QC_ID_012.mzML,OE240_DS_QC_ID_01.mzML,Impact_DA53_mzml.mzML,Bruker_inhouse_mzml.mzML,Blank1_POS_RA1_1_6727.mzXML,BlancFin_POS_RA1_1_6869.mzXML,BlancFin_POS_RA1_1_6869.mzML"/>
      <output name="outputFile" file="metadata_multiple.tabular" ftype="tabular"/>
    </test>
    <test>
      <param name="singleFile" value="SINGLE"/>
      <param name="SingleInputFile" value="BlancFin_POS_RA1_1_6869.mzML"/>
      <output name="outputFile" file="metadata_single.tabular" ftype="tabular"/>
    </test>
  </tests>
<help><![CDATA[
.. class:: infomark

**Credits**
  | **Original tool wrapping:** Quentin Ruin - INRAE - MetaboHUB
  | **Tool maintainer:** Mélanie Pétéra - INRAE - MetaboHUB

.. class:: infomark

**Help and support about what the tool is computing, to be requested here:** https://community.france-bioinformatique.fr/c/workflow4metabolomics/10

-----------------------------------------------------------------------------------------------------------------

*************************
mz(X)MLMetadataCollector
*************************

===========
DESCRIPTION
===========

mz(X)MLMetadataCollector is designed to collect the main information contained in mzML and/or mzXML metadata headers. It can compile the name, format, format version, size (Ko, Mo & Go), MS level, spectrum type, source file, acquisition date, software(s) used, processing method(s), analytical device, number of scans, number of points and encoding method of a single file or an entire collection. The information is packed into a single table (.tabular text file).

-----------------------------------------------------------------------------------------------------------------

==========================
ALIGNMENT WITH OTHER TOOLS
==========================

-----------------------------------------------------------------------------------------------------------------
INPUT FILES
-----------------------------------------------------------------------------------------------------------------

mzML and/or mzXML files

-----------------------------------------------------------------------------------------------------------------
OUTPUT FILES
-----------------------------------------------------------------------------------------------------------------

A tabular text file named metadata.tabular

-----------------------------------------------------------------------------------------------------------------
EXAMPLE OF WORKFLOW POSITION
-----------------------------------------------------------------------------------------------------------------

Directly from raw data or after a conversion tool

-----------------------------------------------------------------------------------------------------------------

===============
TOOL PARAMETERS
===============

- Number of files *(singleFile)*: to select whether there is a single file or a collection as an input
- File(s) to examine *(inputFiles)*: the file or collection to examine

-----------------------------------------------------------------------------------------------------------------

==================
OUTPUT DESCRIPTION
==================

metadata.tabular: a tabular text file containing the features of the metadata as a header and the value of these features for each file as rows

-----------------------------------------------------------------------------------------------------------------

==============
EXAMPLE OF USE
==============

Upload a dataset collection, select them as an input, select the value "Multiple Files" for the Number of files *(singleFile)* parameter and launch the tool.

-----------------------------------------------------------------------------------------------------------------
KNOWN ISSUES
-----------------------------------------------------------------------------------------------------------------

This tool may not cover all types of mzML or mzXML depending on the analytical device and the constructor method of writing metadata into files. As of November 2024, the files obtained via the following software solutions are verified as covered by the tool:

- Bruker DataAnalysis 5.3 (mzML and MZXML)
- Bruker DataAnalysis 6.1 (mzML and MZXML)
- MSConvert > 3.0 (mzML and MZXML)
- Thermo Raw File Parser 1.3.4 (mzML and MZXML)

The fact that the software you use does not appear in this list does not mean the tool won't find the metadata, but some features may be missing.
    
]]>
</help>
<citations>
  <citation type="doi">10.1093/bioinformatics/btu813</citation>
</citations>
</tool>
